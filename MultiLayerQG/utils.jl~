"""
	monoscale_random(hrms, Ktopo, Lx, nx)

Returns a 2D topography field defined by a single length scale with random phases. 
"""

function monoscale_random(hrms, Ktopo, Lx, nx)

	 # Wavenumber grid
	 nk = Int(nx / 2 + 1)
	 nl = nx
	
	 dk = 2 * pi / Lx
	 dl = dk
	 
	 k = reshape( rfftfreq(nx, dk * nx), (nk, 1) )
	 l = reshape( fftfreq(nx, dl * nx), (1, nl) )

	 K = @. sqrt(k^2 + l^2)

	 # Isotropic Gaussian in wavenumber space about mean, Ktopo, with standard deviation, sigma 
	 sigma = sqrt(2) * dk
	 hh = exp.(-(K .- Ktopo).^2 ./ (2 * sigma^2) .* (2 * pi * im .* rand(nk, nl)))

	 # Recover h from hh
	 h = irfft(hh, nx)

	 c = hrms / sqrt.(mean(h.^2))
	 h = c .* h

	 return h
end



"""
	set_q(K0, E0, Lx, nx, Kd, H)

Returns 3D q field with energy localized in spectral space about K = K0, with baroclinic structure, and with total energy equal to E0. 
"""

function set_q(K0, E0, Lx, nx, Kd, H)

	 # Wavenumber grid
         dk = 2 * np.pi / Lx
	 k = fftfreq(nx, 2 * pi / Lx * nx)
         l = k
         kk = k' .* ones(nx)
	 ll = ones(nx)' .* l
         K = sqrt.(kk.^2 + ll.^2)


